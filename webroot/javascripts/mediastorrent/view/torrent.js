/**
 * Created by salorium on 15/03/14.
 */

/*
 <nav class="top-bar" data-topbar>
 <!-- Title -->
 <ul class="title-area">
 <li class="name"></li>

 <!-- Mobile Menu Toggle -->
 <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
 </ul>

 <!-- Top Bar Section -->
 <!--</a><a href="#ADD"><img width="40px"  title="Démarrer un Torrent" src="images/play.svg"/></a><a href="#ADD"><img width="40px"  title="Mettre en pause un Torrent" src="images/pause.svg"/></a><a href="#ADD"><img width="40px"  title="Arrêter un Torrent" src="images/stop.svg"/></a>-->
 <section class="top-bar-section">
 <!--<img src="images/disk.svg" title="Disque dur">
 <!-- Top Bar Left Nav Elements -->
 <ul class="left">
 <li class="has-dropdown"><a>Rtorrent</a>

 <ul class="dropdown">
 <li><a href="#">Dance</a></li>
 <li><a href="#">Hip-hop</a></li>
 </ul>
 </li>
 <li class="divider"></li>
 <li><a href="#" title="Ajouter un Torrent"><img width="40px"   src="<?=BASE_URL?>images/world.svg"/></a></li>
 <li class="divider"></li>
 <li><a href="#" title="Démarrer un Torrent"><img width="40px"   src="<?=BASE_URL?>images/play.svg"/></a></li>
 <li class="divider"></li>
 <li><a href="#" title="Mettre en pause un Torrent"><img width="40px"   src="<?=BASE_URL?>images/pause.svg"/></a></li>
 <li class="divider"></li>
 <li><a href="#" title="Arrêter un Torrent"><img width="40px"   src="<?=BASE_URL?>images/stop.svg"/></a></li>
 <li class="divider"></li>


 </ul>

 <!-- Top Bar Right Nav Elements -->
 <ul class="right">
 <li class="divider hide-for-small"></li>
 <li class="divider"></li>
 <li class="has-form">
 <table id="infoserver" class="infoserver"><tr><td><img width="30px" src="<?=BASE_URL?>images/disk.svg" title="Disque dur"/></td><td><progress title="6.08 Go / 11.05 Go" id="storage" style="width: 150px;" class="diskspace" value="6528540672" max="11873247232"></progress></td></tr></table>

 </li>
 <!-- Divider <img src="images/upload.svg"></td><td>Vitesse <span id="vup">0.1 Ko/s</span> Limite <span id="vupl">2.9 Mo/s</span> Total <span id="vupt">9.22 Ko</span></td><td>|</td><td><img src="images/download.svg"></td><td>Vitesse <span id="vdl">0.1 Ko/s</span> Limite <span id="vdll">Non</span> Total <span id="vdlt">8.31 Ko</span> -->
 <li class="divider"></li>
 <li class="has-form">
 <table id="infoserver" class="infoserver"><tr><td><img width="30px" src="<?=BASE_URL?>images/upload.svg"/></td><td><span id="vup">0.1 Ko/s</span> / <span id="vupl">2.9 Mo/s</span> | <span id="vupt">9.22 Ko</span></td></tr></table>

 </li>
 <li class="divider"></li>
 <li class="has-form">
 <table id="infoserver" class="infoserver"><tr><td><img width="30px" src="<?=BASE_URL?>images/download.svg"/></td><td><span id="vup">0.1 Ko/s</span> / <span id="vupl">2.9 Mo/s</span> | <span id="vupt">9.22 Ko</span></td></tr></table>

 </li>

 <!-- Dropdown -->
 </ul>
 </section></nav>
 <div id="contenu">
 <div class="large-6 columns panel heightfixed">
 <dl class="sub-nav"> <dt>Tri:</dt> <dd class=""><a href="#">Status</a></dd><dd><a href="#">Nom</a></dd><dd class="active"><a href="#">Date d'ajout</a></dd></dl>
 <div id="listorrent"><fieldset idcpt="0" class="torrent torrentselect" id="0C84BFFEF05094633E6D0668D27B472906449086"><legend><table><tbody><tr><td><svg xml:space="preserve" enable-background="new 0 0 512 512" viewBox="0 0 512 512" height="60px" width="60px" y="0px" x="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" title="Arrêté"><path d="M409.338,166.521c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,172.442,50.6,208.161,50.6,249.569c0,50.852,41.37,92.221,93.222,92.221H369.18c50.85,0,92.221-41.369,92.221-92.221C461.4,213.655,440.941,181.724,409.338,166.521z M369.18,301.79H143.821c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844C421.4,278.364,397.975,301.79,369.18,301.79z M278.591,363.455h-45.182v37.802h-33.888v0.463v39.537h112.957V401.72v-0.463h-33.888V363.455z M414.7,401.257h-79.631v40H414.7V401.257z M176.931,401.257H97.3v40h79.631V401.257z" style="fill: gray;"/></svg></td><td>Les.Octonauts.1x42.FRENCH.HDTV.x264-TDPG.mp4</td></tr></tbody></table></legend><table style="width: 100%"><tbody><tr><td width="100%"><progress max="100" value="0" id="p" class="noncomplet"></progress></td><td width="70px" style="text-align:center;min-width:70px; "><span class="pcr">0</span>%</td></tr></tbody></table><table style="width: 100%"><tbody><tr><td width="80px;" style="vertical-align: bottom;">Ajouté</td><td width="170px">: </td><td width="60px;">Seedtime</td><td>: </td><td align="right">Ratio : 0</td></tr><tr><td style="vertical-align: bottom;">Sources</td><td>: 4(0)</td><td>Clients</td><td>: 0(0)</td><td align="right">Upload : - Download : -</td></tr><tr><td style="vertical-align: bottom;">Télécharger</td><td>: 0.00 Ko/73.04 Mo</td><td>Envoyé</td><td>: 0.00 Ko</td><td align="right">Temps restant : ∞</td></tr></tbody></table></fieldset><fieldset idcpt="1" class="torrent " id="844149127AC38370F03C7A0402FCBCE064067B6D"><legend><table><tbody><tr><td><svg xml:space="preserve" enable-background="new 0 0 512 512" viewBox="0 0 512 512" height="60px" width="60px" y="0px" x="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" title="Arrêté"><path d="M409.338,166.521c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,172.442,50.6,208.161,50.6,249.569c0,50.852,41.37,92.221,93.222,92.221H369.18c50.85,0,92.221-41.369,92.221-92.221C461.4,213.655,440.941,181.724,409.338,166.521z M369.18,301.79H143.821c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844C421.4,278.364,397.975,301.79,369.18,301.79z M278.591,363.455h-45.182v37.802h-33.888v0.463v39.537h112.957V401.72v-0.463h-33.888V363.455z M414.7,401.257h-79.631v40H414.7V401.257z M176.931,401.257H97.3v40h79.631V401.257z" style="fill: gray;"/></svg></td><td>Les.Octonauts.1x40.FRENCH.HDTV.x264-TDPG.mp4</td></tr></tbody></table></legend><table style="width: 100%"><tbody><tr><td width="100%"><progress max="100" value="0" id="p" class="noncomplet"></progress></td><td width="70px" style="text-align:center;min-width:70px; "><span class="pcr">0</span>%</td></tr></tbody></table><table style="width: 100%"><tbody><tr><td width="80px;" style="vertical-align: bottom;">Ajouté</td><td width="170px">: </td><td width="60px;">Seedtime</td><td>: </td><td align="right">Ratio : 0</td></tr><tr><td style="vertical-align: bottom;">Sources</td><td>: 5(0)</td><td>Clients</td><td>: 0(0)</td><td align="right">Upload : - Download : -</td></tr><tr><td style="vertical-align: bottom;">Télécharger</td><td>: 0.00 Ko/58.72 Mo</td><td>Envoyé</td><td>: 0.00 Ko</td><td align="right">Temps restant : ∞</td></tr></tbody></table></fieldset><fieldset idcpt="2" class="torrent " id="AB28F7819ADEC3C0732B4C4F03442E63D9835066"><legend><table><tbody><tr><td><svg xml:space="preserve" enable-background="new 0 0 512 512" viewBox="0 0 512 512" height="60px" width="60px" y="0px" x="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" title="Arrêté"><path d="M409.338,166.521c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,172.442,50.6,208.161,50.6,249.569c0,50.852,41.37,92.221,93.222,92.221H369.18c50.85,0,92.221-41.369,92.221-92.221C461.4,213.655,440.941,181.724,409.338,166.521z M369.18,301.79H143.821c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844C421.4,278.364,397.975,301.79,369.18,301.79z M278.591,363.455h-45.182v37.802h-33.888v0.463v39.537h112.957V401.72v-0.463h-33.888V363.455z M414.7,401.257h-79.631v40H414.7V401.257z M176.931,401.257H97.3v40h79.631V401.257z" style="fill: gray;"/></svg></td><td>Les.Octonauts.1x41.FRENCH.HDTV.x264-TDPG.mp4</td></tr></tbody></table></legend><table style="width: 100%"><tbody><tr><td width="100%"><progress max="100" value="0" id="p" class="noncomplet"></progress></td><td width="70px" style="text-align:center;min-width:70px; "><span class="pcr">0</span>%</td></tr></tbody></table><table style="width: 100%"><tbody><tr><td width="80px;" style="vertical-align: bottom;">Ajouté</td><td width="170px">: </td><td width="60px;">Seedtime</td><td>: </td><td align="right">Ratio : 0</td></tr><tr><td style="vertical-align: bottom;">Sources</td><td>: 4(0)</td><td>Clients</td><td>: 0(0)</td><td align="right">Upload : - Download : -</td></tr><tr><td style="vertical-align: bottom;">Télécharger</td><td>: 0.00 Ko/73.70 Mo</td><td>Envoyé</td><td>: 0.00 Ko</td><td align="right">Temps restant : ∞</td></tr></tbody></table></fieldset><fieldset idcpt="3" class="torrent " id="504A51DBDA63E07FC1E13B9C666900D12087A5E3"><legend><table><tbody><tr><td><svg xml:space="preserve" enable-background="new 0 0 512 512" viewBox="0 0 512 512" height="60px" width="60px" y="0px" x="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" title="Envoi"><path d="m 409.338,216.254 c -10.416,-54.961 -58.666,-95.777 -115.781,-95.777 -35.098,0 -67.631,15.285 -89.871,41.584 -37.148,-9.906 -76.079,11.781 -86.933,48.779 C 78.16,222.176 50.6,257.895 50.6,299.303 c 0,50.852 41.37,92.221 93.222,92.221 l 225.358,0 c 50.85,0 92.221,-41.369 92.221,-92.221 -0.001,-35.914 -20.46,-67.846 -52.063,-83.049 z m -40.158,135.269 -225.359,0 c -29.795,0 -53.222,-23.426 -53.222,-52.221 0,-34.078 27.65,-60.078 62.186,-53.816 -11.536,-39.596 44.131,-61.93 64.641,-32.348 5.157,-14.582 25.823,-52.662 76.131,-52.662 38.027,0 77.361,26.08 78.664,84.982 25.363,0.098 49.18,18.432 49.18,53.844 -0.001,28.796 -23.426,52.221 -52.221,52.221 z m -133.90703,-77.57749 -28.75689,0.11871 59.23404,-59.82071 59.72327,59.32967 -28.75602,0.1187 0.25445,61.64094 -61.44441,0.25364 z" style="fill: #18C72F;"/></svg></td><td>Les.Octonauts.1x44.FRENCH.HDTV.x264-TDPG.mp4</td></tr></tbody></table></legend><table style="width: 100%"><tbody><tr><td width="100%"><progress max="100" value="100" id="p" class="ul"></progress></td><td width="70px" style="text-align:center;min-width:70px; "><span class="pcr">100</span>%</td></tr></tbody></table><table style="width: 100%"><tbody><tr><td width="80px;" style="vertical-align: bottom;">Ajouté</td><td width="170px">: </td><td width="60px;">Seedtime</td><td>: </td><td align="right">Ratio : 0</td></tr><tr><td style="vertical-align: bottom;">Sources</td><td>: 5(0)</td><td>Clients</td><td>: 0(0)</td><td align="right">Upload : - Download : -</td></tr><tr><td style="vertical-align: bottom;">Télécharger</td><td>: 57.09 Mo/57.09 Mo</td><td>Envoyé</td><td>: 0.00 Ko</td><td align="right">Temps restant : ∞</td></tr></tbody></table></fieldset><span onclick="Torrent.next(1)" style="display: block;text-align: center;padding: 2px;">▼</span></div>

 </div>
 <div class="large-6 columns panel heightfixed"><dl class="tabs" data-tab> <dd class="active"><a href="#panel2-1">Tab 1</a></dd> <dd><a href="#panel2-2">Tab 2</a></dd> <dd><a href="#panel2-3">Tab 3</a></dd> <dd><a href="#panel2-4">Tab 4</a></dd> </dl> <div class="tabs-content"> <div class="content active" id="panel2-1"> <p>First panel content goes here... Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur enim fuga fugiat laboriosam sapiente voluptate voluptatum. Adipisci animi itaque ullam vitae? Accusantium alias aspernatur, atque dolorum hic odit quas tempore.</p> </div> <div class="content" id="panel2-2"> <p>Second panel content goes here...</p> </div> <div class="content" id="panel2-3"> <p>Third panel content goes here...</p> </div> <div class="content" id="panel2-4"> <p>Fourth panel content goes here...</p> </div> </div></div>
 </div>
 */

Torrent.view =  {
    fixedHeightContainer : function(hauteur){
        Base.view.fixedHeight("#contenu",hauteur);
    },
    initSeedbox: function(selectionne){
        if ( ! Torrent.model.changedurl){
        seedbox = Torrent.model.seedboxs;
        res = "";
        for ( i=seedbox.length-1;i>-1;i--){
            v = seedbox[i];
            if ( i != selectionne)
            res = '<li><a onclick="Torrent.controller.reloadSeedbox('+i+')">'+ v.nom+'</a></li>' +res;
        }
        if ( res.length == 0){
            $("#seedbox").removeClass("has-dropdown not-click");
            res = '<a>'+seedbox[selectionne].nom+'</a>';
        }else{
            $("#seedbox").addClass("has-dropdown not-click");
            res = '<a>'+seedbox[selectionne].nom+'</a><ul class="dropdown">'+res+'</ul>';
        }
        Torrent.model.baseUrl = seedbox[selectionne].hostname;
            Torrent.model.nomseedbox = seedbox[selectionne].nom;
        $("#seedbox").html(res);
            if ( !Torrent.model.updated){
                Torrent.model.updated = true;
                Torrent.controller.update("");
            }
        }
    },
    getIconDessin:function (name){
        switch (name){
            case "checking":
                return 'M409.338,216.254c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584'+
                    'c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,222.176,50.6,257.895,50.6,299.303c0,50.852,41.37,92.221,93.222,92.221H369.18'+
                    'c50.85,0,92.221-41.369,92.221-92.221C461.4,263.389,440.941,231.457,409.338,216.254z M369.18,351.523H143.821'+
                    'c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348'+
                    'c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844'+
                    'C421.4,328.098,397.975,351.523,369.18,351.523z M193.019,273.39h15.715c0.458-31.007,25.821-56.092,56.933-56.092'+
                    'c13.515,0,26.622,4.829,36.909,13.6l0.705,0.6l-13.956,13.956l-0.597-0.472c-6.635-5.236-14.608-8.006-23.062-8.006'+
                    'c-20.259,0-36.794,16.258-37.25,36.414h16.007l-25.715,25.706L193.019,273.39z M321.952,273.142'+
                    'c-0.458,31.009-25.821,56.094-56.933,56.094c-13.523,0-26.64-4.837-36.931-13.618l-0.704-0.601l13.955-13.954l0.597,0.472'+
                    'c6.639,5.248,14.62,8.021,23.083,8.021c20.26,0,36.794-16.258,37.25-36.414h-16.006l25.715-25.705l25.688,25.705H321.952z';
                break;
            case "queue":
                return 'M409.338,216.254c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584'+
                    'c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,222.176,50.6,257.895,50.6,299.303c0,50.852,41.37,92.221,93.222,92.221H369.18'+
                    'c50.85,0,92.221-41.369,92.221-92.221C461.4,263.389,440.941,231.457,409.338,216.254z M369.18,351.523H143.821'+
                    'c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348'+
                    'c5.158-14.582,25.824-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844'+
                    'C421.4,328.098,397.975,351.523,369.18,351.523z M264.756,333.012c-28.891,0-52.678-21.721-55.678-50.046l16.461-3.281'+
                    'c1.406,20.414,18.477,36.628,39.217,36.628c21.695,0,39.348-17.649,39.348-39.347c0-21.696-17.652-39.347-39.348-39.347'+
                    'c-9.793,0-19.569,3.517-26.661,9.503l10.837,10.838l-41.046,7.493l7.493-41.047l10.883,10.883'+
                    'c10.158-9.034,24.356-14.368,38.494-14.368c30.904,0,56.047,25.142,56.047,56.045C320.803,307.87,295.66,333.012,264.756,333.012z'+
                    'M286.135,276.753v12.423h-30.397v-32.644h12.423v20.221H286.135z';
                break;
            case 'pause':
                return 'm 409.338,216.254 c -10.416,-54.961 -58.666,-95.777 -115.781,-95.777 -35.098,0 -67.631,15.285 -89.871,41.584 -37.148,-9.906 -76.079,11.781 -86.933,48.779 C 78.16,222.176 50.6,257.895 50.6,299.303 c 0,50.852 41.37,92.221 93.222,92.221 l 225.358,0 c 50.85,0 92.221,-41.369 92.221,-92.221 -0.001,-35.914 -20.46,-67.846 -52.063,-83.049 z m -40.158,135.269 -225.359,0 c -29.795,0 -53.222,-23.426 -53.222,-52.221 0,-34.078 27.65,-60.078 62.186,-53.816 -11.536,-39.596 44.131,-61.93 64.641,-32.348 5.157,-14.582 25.823,-52.662 76.131,-52.662 38.027,0 77.361,26.08 78.664,84.982 25.363,0.098 49.18,18.432 49.18,53.844 -0.001,28.796 -23.426,52.221 -52.221,52.221 z m -117.40686,-126.225 0,107.05664 -43.27771,0 0,-107.05664 z m 28.69177,107.05664 0,-107.05664 43.03766,0 0,107.05664 z';
                break;
            case 'ul':
                return 'm 409.338,216.254 c -10.416,-54.961 -58.666,-95.777 -115.781,-95.777 -35.098,0 -67.631,15.285 -89.871,41.584 -37.148,-9.906 -76.079,11.781 -86.933,48.779 C 78.16,222.176 50.6,257.895 50.6,299.303 c 0,50.852 41.37,92.221 93.222,92.221 l 225.358,0 c 50.85,0 92.221,-41.369 92.221,-92.221 -0.001,-35.914 -20.46,-67.846 -52.063,-83.049 z m -40.158,135.269 -225.359,0 c -29.795,0 -53.222,-23.426 -53.222,-52.221 0,-34.078 27.65,-60.078 62.186,-53.816 -11.536,-39.596 44.131,-61.93 64.641,-32.348 5.157,-14.582 25.823,-52.662 76.131,-52.662 38.027,0 77.361,26.08 78.664,84.982 25.363,0.098 49.18,18.432 49.18,53.844 -0.001,28.796 -23.426,52.221 -52.221,52.221 z m -133.90703,-77.57749 -28.75689,0.11871 59.23404,-59.82071 59.72327,59.32967 -28.75602,0.1187 0.25445,61.64094 -61.44441,0.25364 z';
                break;
            case 'dl':
                return 'm 409.338,216.254 c -10.416,-54.961 -58.666,-95.777 -115.781,-95.777 -35.098,0 -67.631,15.285 -89.871,41.584 -37.148,-9.906 -76.079,11.781 -86.933,48.779 C 78.16,222.176 50.6,257.895 50.6,299.303 c 0,50.852 41.37,92.221 93.222,92.221 l 225.358,0 c 50.85,0 92.221,-41.369 92.221,-92.221 -0.001,-35.914 -20.46,-67.846 -52.063,-83.049 z m -40.158,135.269 -225.359,0 c -29.795,0 -53.222,-23.426 -53.222,-52.221 0,-34.078 27.65,-60.078 62.186,-53.816 -11.536,-39.596 44.131,-61.93 64.641,-32.348 5.157,-14.582 25.823,-52.662 76.131,-52.662 38.027,0 77.361,26.08 78.664,84.982 25.363,0.098 49.18,18.432 49.18,53.844 -0.001,28.796 -23.426,52.221 -52.221,52.221 z m -72.44351,-67.76373 28.75617,-0.23586 -58.98986,60.06152 -59.96447,-59.08589 28.7553,-0.23584 -0.50555,-61.63939 61.44286,-0.50394 z';
                break;
            case 'error':
                return 'm 406.104,227.64 c -4.444,-55.967 -51.26801,-100 -108.37601,-100 -38.81699,0 -72.87799,20.34801 -92.11398,50.953 -36.18201,-20.457 -82.326,3.61099 -85.21701,45.89799 C 80.72899,229.34898 50,263.13198 50,304.11401 c 0,44.31799 35.928,80.246 80.246,80.246 l 251.508,0 c 44.31799,0 80.246,-50.92801 80.246,-80.246 0,-35.828 -23.48401,-66.16202 -55.896,-76.47401 z m -175.37135,-1.71023 35.26464,35.25897 35.25473,-35.26322 21.96958,21.95258 -35.26465,35.26464 35.26748,35.26323 -21.95683,21.96391 -35.27031,-35.27031 -35.27031,35.27598 -21.94975,-21.96392 35.26465,-35.26747 -35.27031,-35.26465 z';
                break;
            case 'terminer':
                return 'M409.338,216.254c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584'+
                    'c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,222.176,50.6,257.895,50.6,299.303c0,50.852,41.37,92.221,93.222,92.221H369.18'+
                    'c50.85,0,92.221-41.369,92.221-92.221C461.4,263.389,440.941,231.457,409.338,216.254z M369.18,351.523H143.821'+
                    'c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348'+
                    'c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844'+
                    'C421.4,328.098,397.975,351.523,369.18,351.523z M248.105,322.5c-19.184-22.593-31.987-36.996-55.547-58.833l11.78-10.892'+
                    'c13.781,6.668,22.52,11.741,38.008,22.782c29.118-33.043,48.358-49.807,84.121-72.058l3.835,8.816'+
                    'C300.81,238.055,279.209,266.722,248.105,322.5z';

                break;
            case "noncomplet":
                return 'M409.338,166.521c-10.416-54.961-58.666-95.777-115.781-95.777c-35.098,0-67.631,15.285-89.871,41.584'+
                    'c-37.148-9.906-76.079,11.781-86.933,48.779C78.16,172.442,50.6,208.161,50.6,249.569c0,50.852,41.37,92.221,93.222,92.221H369.18'+
                    'c50.85,0,92.221-41.369,92.221-92.221C461.4,213.655,440.941,181.724,409.338,166.521z M369.18,301.79H143.821'+
                    'c-29.795,0-53.222-23.426-53.222-52.221c0-34.078,27.65-60.078,62.186-53.816c-11.536-39.596,44.131-61.93,64.641-32.348'+
                    'c5.157-14.582,25.823-52.662,76.131-52.662c38.027,0,77.361,26.08,78.664,84.982c25.363,0.098,49.18,18.432,49.18,53.844'+
                    'C421.4,278.364,397.975,301.79,369.18,301.79z M278.591,363.455h-45.182v37.802h-33.888v0.463v39.537h112.957V401.72v-0.463h-33.888'+
                    'V363.455z M414.7,401.257h-79.631v40H414.7V401.257z M176.931,401.257H97.3v40h79.631V401.257z';
                break;
        }
    },
    analiseState: function(state,done){
        status = "";
        icon = null;
        if ( state & Torrent.model.dStatus.checking){
            icon = {name: "checking",color: "orange", colorname:"checking"};
            status = "Vérification";
        }else if (state & Torrent.model.dStatus.hashing){
            icon = {name: "queue",color: "purple", colorname:"queue"};
            status = "Mis dans la file";
        }else{
            if (state & Torrent.model.dStatus.started){
                if (state & Torrent.model.dStatus.paused){
                    icon = {name: "pause",color: "gold", colorname:"pause"};
                    status = "Pause";
                }else{
                    icon = (done == 1000) ? {name: "ul",color: "#18C72F", colorname:"ul"}:{name: "dl",color: "#1832C7", colorname:"dl"};
                    status = (done == 1000) ? "Envoi": "Téléchargement";
                }

            }
        }
        if ((done < 1000) && status === ""){
            icon = {name: "noncomplet",color: "gray", colorname:"noncomplet"};
            status = "Arrêté";
        }
        if ( state & Torrent.model.dStatus.error){
            if (icon == null){
                icon = {name: "error",color: "#FF0000", colorname:"error"};
            }else{
                icon.color = "#FF0000";
                icon.colorname = "error";
            }
        }
        if ( done == 1000 && status ==""){
            icon = {name: "terminer",color: "mediumseagreen", colorname:"terminer"};
            status = "Terminé";
        }
        return [status,icon];
    },
    listeTorrent: function( torrent,cpt){
        if ( torrent == null)
        torrent= [];
        if ( torrent.length== 0){
            state = this.analiseState(1,100);
        }else{
            state = this.analiseState(torrent[0],torrent[3]);

        }
        return '<fieldset id="'+torrent[27]+'" class="torrent '+($.inArray(torrent[27],Torrent.model.listeselectionnee) > -1 ? "torrentselect":"")+'" idcpt="'+cpt+'"><legend><table><tr><td><svg title="'+state[0]+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="60px" height="60px"  viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">'+
            '<path style="fill: '+state[1].color+';" d="'+this.getIconDessin(state[1].name)+'"/></svg></td><td>'+(torrent[1]?torrent[1]:"Test" )+'</td></tr></table></legend>'+
            '<table style="width: 100%"><tr><td width="100%"><progress class="'+state[1].colorname+'" id="p" value="'+(torrent[3]?torrent[3]/10:"0" )+'" max="100"></progress></td><td  width="70px" style="text-align:center;min-width:70px; "><span class="pcr">'+(torrent[3]?torrent[3]/10:"0" )+'</span>%</td></tr></table>'+
            '<table style="width: 100%">'+
            '<tr><td width="80px;" style="vertical-align: bottom;">Ajouté</td><td width="170px">: '+((torrent[25]>3600*24*365) ? Base.model.converter.date(Base.model.converter.iv(torrent[25])) : "")+'</td><td width="60px;">Seedtime</td><td>: '+((torrent[24]>3600*24*365) ? Base.model.converter.time(new Date().getTime()/1000-(Base.model.converter.iv(torrent[24])),true) : "")+'</td><td align="right">Ratio : '+torrent[6]/1000+'</td></tr>'+
            '<tr><td style="vertical-align: bottom;">Sources</td><td>: '+(torrent[13]?torrent[13]:"0" )+'('+(torrent[11]?torrent[11]:"0" )+')</td><td>Clients</td><td>: '+(torrent[12]?torrent[12]:"0" )+'('+(torrent[10]?torrent[10]:"0" )+')</td><td align="right">Upload : '+(Base.model.converter.speed(torrent[7]) != "" ? Base.model.converter.speed(torrent[7]):"-")+' Download : '+(Base.model.converter.speed(torrent[8]) != "" ? Base.model.converter.speed(torrent[8]):"-")+'</td></tr>'+
            '<tr><td style="vertical-align: bottom;">Télécharger</td><td >: '+(Base.model.converter.bytes(torrent[4],2)!= ""? Base.model.converter.bytes(torrent[4],2):"-" )+'/'+(Base.model.converter.bytes(torrent[2],2)!= ""? Base.model.converter.bytes(torrent[2],2):"-" )+'</td><td>Envoyé</td><td>: '+(Base.model.converter.bytes(torrent[5],2)!= ""? Base.model.converter.bytes(torrent[5],2):"-" )+'</td><td align="right">Temps restant : '+(torrent[9] != -1 ? Base.model.converter.time(torrent[9]):"∞")+'</td></tr>'+
            '</table></fieldset>';
    },
    detailsTorrent:function(){
        if ( Torrent.model.detailliste.length >0){
            $("#torrentdetailnom").html(Torrent.model.detailliste[1]);
            $("#torrentdetaildateaj").html(((Torrent.model.detailliste[25]>3600*24*365) ? Base.model.converter.date(Base.model.converter.iv(Torrent.model.detailliste[25])) : ""));
            $("#torrentdetailrep").html(Torrent.model.detailliste[18]);
            $("#torrentdetailhash").html(Torrent.model.detailliste[27]);
            $("#torrentdetailinfos").html(Torrent.model.detailliste[26]);

            $("#torrentdetailtempsecoule").html(Base.model.converter.time((new Date().getTime()-Torrent.model.detailliste[16]*1000)/1000));
            $("#torrentdetailrestant").html((Torrent.model.detailliste[9] != -1 ? Base.model.converter.time(Torrent.model.detailliste[9]):"∞"));
            $("#torrentdetaildl").html((Base.model.converter.bytes(Torrent.model.detailliste[4],2)!= ""? Base.model.converter.bytes(Torrent.model.detailliste[4],2):"-" ));
            $("#torrentdetailvdl").html((Base.model.converter.speed(Torrent.model.detailliste[8]) != "" ? Base.model.converter.speed(Torrent.model.detailliste[8]):"-"));
            $("#torrentdetailul").html((Base.model.converter.bytes(Torrent.model.detailliste[5],2)!= ""? Base.model.converter.bytes(Torrent.model.detailliste[5],2):"-" ));
            $("#torrentdetailvul").html((Base.model.converter.speed(Torrent.model.detailliste[7]) != "" ? Base.model.converter.speed(Torrent.model.detailliste[7]):"-"));
            $("#torrentdetailsource").html((Torrent.model.detailliste[11]?Torrent.model.detailliste[11]:"0" )+" de "+(Torrent.model.detailliste[13]?Torrent.model.detailliste[13]:"0" )+" connecté(s)");
            $("#torrentdetailclient").html((Torrent.model.detailliste[10]?Torrent.model.detailliste[10]:"0" )+" de "+(Torrent.model.detailliste[12]?Torrent.model.detailliste[12]:"0" )+" connecté(s)");
            $("#torrentdetailrejete").html(Base.model.converter.bytes(Torrent.model.detailliste[17],2));
            $("#torrentdetailratio").html(Torrent.model.detailliste[6]/1000);
        }else{
            $("#torrentdetailnom").html("");
            $("#torrentdetaildateaj").html("");
            $("#torrentdetailrep").html("");
            $("#torrentdetailhash").html("");

            $("#torrentdetailtempsecoule").html("");
            $("#torrentdetailrestant").html("");
            $("#torrentdetaildl").html("");
            $("#torrentdetailvdl").html("");
            $("#torrentdetailul").html("");
            $("#torrentdetailvul").html("");
            $("#torrentdetailsource").html("");
            $("#torrentdetailclient").html("");
            $("#torrentdetailrejete").html("");
            $("#torrentdetailratio").html("");
        }
    },
    filesTorrentListe:function(){
        $("#torrentdetailsfiles").empty();
            if (Torrent.model.fileliste.length > 0)
            $.each( Torrent.model.fileliste, function(k,v){
                 var $tr = $('<tr style="cursor: pointer;" class="'+($.inArray(v[0]+"",Torrent.model.fileselectionnee) > -1 ?"active":"")+'" id="file'+k+'" data-cpt="'+k+'" data-id="'+v[0]+'" ondblclick="Torrent.controller.downloadFileTorrent('+k+');"><td>'+Base.model.path.basename(v[1])+'</td><td>'+Base.model.converter.bytes(v[4],2)+'</td><td>'+Base.model.converter.bytes(v[4]*v[2]/v[3],2)+'</td><td><progress class="'+(v[2]==v[3] ? "ul":"dl")+'"  value="'+v[2]+'" max="'+v[3]+'" title="'+(v[2] != 0 ?v[2]/v[3]*100:0)+'%"></progress></td><td>'+Torrent.model.fileinfospriorite[v[5]]+'</td></tr>');

                $("#torrentdetailsfiles").append(
                    $tr
                );
                $tr.mousedown(function(e) {
                    e.preventDefault();
                    switch (e.which){
                        case 1:
                            //clique gauche
                            if (e.shiftKey) { //Clique gauche avec Shift
                                Torrent.model.fileselectionnee = [];
                                if ( Torrent.model.fileselectionneeid > -1){
                                    max = Base.model.converter.iv($(e.currentTarget).attr("data-cpt"));
                                    i1 = Base.model.converter.iv(Torrent.model.fileselectionneeid);
                                    if (i1 < max ){
                                        for (i=i1;i< max;i++){

                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-id"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }else{
                                        for (i=i1;i> max;i--){
                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-id"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-id"));
                                }else{
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-id"));
                                }
                                $(e.currentTarget).addClass("active");
                                //  mon action
                            }else if (e.ctrlKey){//Clique gauche avec CTRL
                                id = $.inArray($(e.currentTarget).attr("data-id"),Torrent.model.fileselectionnee);
                                if (id > -1){
                                    $(e.currentTarget).removeClass("active");
                                    Torrent.model.fileselectionnee.splice(id,1);
                                }else{
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-id"));
                                    $(e.currentTarget).addClass("active");
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-id");
                                }
                            }else{//Clique gauche
                                Torrent.model.fileselectionnee=[];
                                Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-id"));
                                Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                $(e.currentTarget).parent().children().removeClass("active");
                                $(e.currentTarget).addClass("active");
                            }
                            break;
                        case 3:
                            //clique droit
                            id= $.inArray($(e.currentTarget).attr("data-id"),Torrent.model.fileselectionnee);
                            if ( id > -1 && Torrent.model.fileselectionnee.length > 1){
                                // console.log(e);
                                var button = [];
                                var subutton = [];
                                if (v[5] !=2 ){
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                }
                                if (v[5] !=1 ){
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                }
                                if (v[5] !=0 ){
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                }
                                button.push({nom:"Priorité",dest : subutton});
                                /*button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                if ( Base.model.path.ext(v[1]) == "avi" || Base.model.path.ext(v[1]) == "mp4" || Base.model.path.ext(v[1]) == "mkv"){
                                    button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                }*/
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }else{
                            Torrent.model.fileselectionnee=[];
                            Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-id"));
                            $(e.currentTarget).parent().children().removeClass("active");
                            $(e.currentTarget).addClass("active");
                                var button = [];
                                var subutton = [];
                                if (v[5] !=2 ){
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                }
                                if (v[5] !=1 ){
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                }
                                if (v[5] !=0 ){
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                }
                                button.push({nom:"Priorité",dest : subutton});
                                button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                if ( Base.model.path.ext(v[1]) == "avi" || Base.model.path.ext(v[1]) == "mp4" || Base.model.path.ext(v[1]) == "mkv"){
                                    button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                }
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }
                            break;
                    }

                });

            });
            //panel2-2

    },
    filesTorrentArbre:function(){
        $("#torrentdetailsfiles").empty();
        if (Torrent.model.filelistenavigation.length > 0){
             //Parcour dossier
            list = Torrent.model.filelistenavigation[Torrent.model.filenavigationou];
            if (!isNaN(list.back) ){
                var $tr = $('<tr style="cursor: pointer;" ><td><img width="30" src="'+Base.model.conf.base_url+'images/dossier.svg">..</td><td></td><td></td><td></td><td></td></tr>');

                $("#torrentdetailsfiles").append(
                    $tr
                );
                $tr.dblclick ( function(e){
                    e.preventDefault();
                    Torrent.model.fileselectionnee = [];
                    Torrent.model.filenavigationou = list.back;
                    Torrent.view.filesTorrentArbre();
                });
            }
            var cpt = 0;
            $.each(list.dossier, function(k,v){
                var $tr = $('<tr style="cursor: pointer;" class="'+($.inArray(cpt+"",Torrent.model.fileselectionnee) > -1 ?"active":"")+'" id="file'+cpt+'" data-cpt="'+cpt+'" data-dossier="1" data-dossierk="'+k+'"><td><img width="30" src="'+Base.model.conf.base_url+'images/dossier.svg">'+v[0]+'</td><td>'+Base.model.converter.bytes(v[4],2)+'</td><td>'+Base.model.converter.bytes(v[4]*v[2]/v[3],2)+'</td><td><progress class="'+(v[2]==v[3] ? "ul":"dl")+'"  value="'+v[2]+'" max="'+v[3]+'" title="'+(v[2] != 0 ?v[2]/v[3]*100:0)+'%"></progress></td><td>'+Torrent.model.getPriorite(v[5])+'</td></tr>');

                $("#torrentdetailsfiles").append(
                    $tr
                );
                $tr.dblclick ( function(e){
                    e.preventDefault();
                    Torrent.model.fileselectionnee = [];
                    Torrent.model.filenavigationou = v[1];
                    Torrent.view.filesTorrentArbre();
                });

                $tr.mousedown(function(e) {
                    e.preventDefault();
                    switch (e.which){
                        case 1:
                            //clique gauche
                            if (e.shiftKey) { //Clique gauche avec Shift
                                Torrent.model.fileselectionnee = [];
                                Torrent.model.fileselectionneenofile = [];
                                if ( Torrent.model.fileselectionneeid > -1){
                                    max = Base.model.converter.iv($(e.currentTarget).attr("data-cpt"));
                                    i1 = Base.model.converter.iv(Torrent.model.fileselectionneeid);
                                    if (i1 < max ){
                                        for (i=i1;i< max;i++){
                                            if ($("#file"+i).attr("data-dossier") === "1" ){
                                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(Torrent.model.filelistenavigation[Torrent.model.filenavigationou].dossier[$("#file"+i).attr("data-dossierk")][6]);
                                            }else{
                                                Torrent.model.fileselectionneenofile.push($("#file"+i).attr("data-id"));
                                            }
                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-cpt"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }else{
                                        for (i=i1;i> max;i--){
                                            if ($("#file"+i).attr("data-dossier") === "1" ){
                                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(Torrent.model.filelistenavigation[Torrent.model.filenavigationou].dossier[$("#file"+i).attr("data-dossierk")][6]);
                                            }else{
                                                Torrent.model.fileselectionneenofile.push($("#file"+i).attr("data-id"));
                                            }
                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-cpt"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(v[6]);
                                }else{
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(v[6]);
                                }
                                $(e.currentTarget).addClass("active");
                                //  mon action
                            }else if (e.ctrlKey){//Clique gauche avec CTRL
                                id = $.inArray($(e.currentTarget).attr("data-cpt"),Torrent.model.fileselectionnee);
                                if (id > -1){
                                    $(e.currentTarget).removeClass("active");
                                    Torrent.model.fileselectionnee.splice(id,1);
                                    $.each( v[6],function(k,vv){
                                    Torrent.model.fileselectionneenofile.splice(Torrent.model.fileselectionneenofile.indexOf(vv), 1);
                                    });
                                }else{
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(v[6]);
                                    $(e.currentTarget).addClass("active");
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                }
                            }else{//Clique gauche
                                Torrent.model.fileselectionnee=[];
                                Torrent.model.fileselectionneenofile = [];
                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(v[6]);
                                Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                $(e.currentTarget).parent().children().removeClass("active");
                                $(e.currentTarget).addClass("active");
                            }
                            break;
                        case 3:
                            //clique droit
                            id= $.inArray($(e.currentTarget).attr("data-cpt"),Torrent.model.fileselectionnee);
                            if ( id > -1 && Torrent.model.fileselectionnee.length > 1){
                                console.log("ici");
                                // console.log(e);
                                var button = [];
                                var subutton = [];
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                button.push({nom:"Priorité",dest : subutton});
                                /*button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                 if ( Base.model.path.ext(v[1]) == "avi" || Base.model.path.ext(v[1]) == "mp4" || Base.model.path.ext(v[1]) == "mkv"){
                                 button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                 }*/
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }else{
                                Torrent.model.fileselectionnee=[];
                                Torrent.model.fileselectionneenofile=[];
                                Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(v[6]);
                                $(e.currentTarget).parent().children().removeClass("active");
                                $(e.currentTarget).addClass("active");
                                var button = [];
                                var subutton = [];
                                if (v[5] !=2 ){
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                }
                                if (v[5] !=1 ){
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                }
                                if (v[5] !=0 ){
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                }
                                button.push({nom:"Priorité",dest : subutton});
                                /*button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                if ( Base.model.path.ext(v[1]) == "avi" || Base.model.path.ext(v[1]) == "mp4" || Base.model.path.ext(v[1]) == "mkv"){
                                    button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                }*/
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }
                            break;
                    }

                });


                cpt++;
            });
            $.each(list.file, function(k,v){
                var $tr = $('<tr style="cursor: pointer;" class="'+($.inArray(cpt+"",Torrent.model.fileselectionnee) > -1 ?"active":"")+'" id="file'+cpt+'" data-cpt="'+cpt+'" data-dossier="0" data-id="'+v[1]+'"><td><img width="30" src="'+Base.model.conf.base_url+'images/fichier.svg">'+v[0]+'</td><td>'+Base.model.converter.bytes(v[4],2)+'</td><td>'+Base.model.converter.bytes((v[3] != 0 ? v[4]*v[2]/v[3]: 0),2)+'</td><td><progress class="'+(v[2]==v[3] ? "ul":"dl")+'"  value="'+(v[3] != 0 ? v[2] :1)+'" max="'+v[3] +'" title="'+(v[3] != 0 ? v[2]/v[3]*100:100)+'%"></progress></td><td>'+Torrent.model.getPriorite(v[5])+'</td></tr>');

                $("#torrentdetailsfiles").append(
                    $tr
                );
                $tr.mousedown(function(e) {
                    e.preventDefault();
                    switch (e.which){
                        case 1:
                            //clique gauche
                            if (e.shiftKey) { //Clique gauche avec Shift
                                Torrent.model.fileselectionnee = [];
                                Torrent.model.fileselectionneenofile = [];
                                if ( Torrent.model.fileselectionneeid > -1){
                                    max = Base.model.converter.iv($(e.currentTarget).attr("data-cpt"));
                                    i1 = Base.model.converter.iv(Torrent.model.fileselectionneeid);
                                    if (i1 < max ){
                                        for (i=i1;i< max;i++){
                                            if ($("#file"+i).attr("data-dossier") === "1" ){
                                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(Torrent.model.filelistenavigation[Torrent.model.filenavigationou].dossier[$("#file"+i).attr("data-dossierk")][6]);
                                            }else{
                                                Torrent.model.fileselectionneenofile.push($("#file"+i).attr("data-id"));
                                            }
                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-cpt"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }else{
                                        for (i=i1;i> max;i--){
                                            if ($("#file"+i).attr("data-dossier") === "1" ){
                                                Torrent.model.fileselectionneenofile =Torrent.model.fileselectionneenofile.concat(Torrent.model.filelistenavigation[Torrent.model.filenavigationou].dossier[$("#file"+i).attr("data-dossierk")][6]);
                                            }else{
                                                Torrent.model.fileselectionneenofile.push($("#file"+i).attr("data-id"));
                                            }
                                            Torrent.model.fileselectionnee.push($("#file"+i).attr("data-cpt"));
                                            $("#file"+i).addClass("active");
                                        }
                                    }
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    Torrent.model.fileselectionneenofile.push(v[1]);
                                }else{
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    Torrent.model.fileselectionneenofile.push(v[1]);
                                }
                                $(e.currentTarget).addClass("active");
                                //  mon action
                            }else if (e.ctrlKey){//Clique gauche avec CTRL
                                id = $.inArray($(e.currentTarget).attr("data-cpt"),Torrent.model.fileselectionnee);
                                if (id > -1){
                                    $(e.currentTarget).removeClass("active");
                                    Torrent.model.fileselectionnee.splice(id,1);
                                    Torrent.model.fileselectionneenofile.splice(Torrent.model.fileselectionneenofile.indexOf(v[1]), 1);
                                }else{
                                    Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                    $(e.currentTarget).addClass("active");
                                    Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                    Torrent.model.fileselectionneenofile.push(v[1]);
                                }
                            }else{//Clique gauche
                                Torrent.model.fileselectionnee=[];
                                Torrent.model.fileselectionneenofile = [];
                                Torrent.model.fileselectionneenofile.push(v[1]);
                                Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                Torrent.model.fileselectionneeid = $(e.currentTarget).attr("data-cpt");
                                $(e.currentTarget).parent().children().removeClass("active");
                                $(e.currentTarget).addClass("active");
                            }
                            break;
                        case 3:
                            //clique droit
                            id= $.inArray($(e.currentTarget).attr("data-cpt"),Torrent.model.fileselectionnee);
                            if ( id > -1 && Torrent.model.fileselectionnee.length > 1){
                                // console.log(e);
                                var button = [];
                                var subutton = [];
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                button.push({nom:"Priorité",dest : subutton});
                                /*button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                 if ( Base.model.path.ext(v[0]) == "avi" || Base.model.path.ext(v[0]) == "mp4" || Base.model.path.ext(v[0]) == "mkv"){
                                 button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-cpt"));}});
                                 }*/
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }else{
                                Torrent.model.fileselectionnee=[];
                                Torrent.model.fileselectionneenofile = [];
                                Torrent.model.fileselectionneenofile.push(v[1]);
                                Torrent.model.fileselectionnee.push($(e.currentTarget).attr("data-cpt"));
                                $(e.currentTarget).parent().children().removeClass("active");
                                $(e.currentTarget).addClass("active");
                                var button = [];
                                var subutton = [];
                                if (v[5] !=2 ){
                                    subutton.push({nom:"Haute", dest: function(){Torrent.controller.prioriteFileTorrent(2);}})
                                }
                                if (v[5] !=1 ){
                                    subutton.push({nom:"Normal", dest: function(){Torrent.controller.prioriteFileTorrent(1);}})
                                }
                                if (v[5] !=0 ){
                                    subutton.push({nom:"Ne pas télécharger", dest: function(){Torrent.controller.prioriteFileTorrent(0);}})
                                }
                                button.push({nom:"Priorité",dest : subutton});
                                button.push({nom:"Télécharger",dest : function(){Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-id"));}});
                                 if ( Base.model.path.ext(v[0]) == "avi" || Base.model.path.ext(v[0]) == "mp4" || Base.model.path.ext(v[0]) == "mkv"){
                                 button.push({nom:"Streaming",dest : function(){Torrent.controller.streamingFileTorrent($(e.currentTarget).attr("data-id"));}});
                                 }
                                Base.model.pannelClicDroit.make(button, e.clientX,e.clientY);
                            }
                            break;
                    }

                });
                $tr.dblclick ( function(e){
                    e.preventDefault();
                    Torrent.controller.downloadFileTorrent($(e.currentTarget).attr("data-id"));
                });
                cpt++


            });
        }
            /*$.each( Torrent.model.filelistenavigation[Torrent.model.filenavigationou], function(k,v){
            console.log(v);
            });*/
        //panel2-2

    },
    fileTorrentsStreaming : function (src){
        var $div = $("<div style='position: absolute; top 50px;left: 50px; z-index: 100;display: block;'></div>");
        $button = $("<button>Close</button>");
        $button.click(function(e){
            e.preventDefault();
            $div.remove();
        });
        $div.append($button);
        $div.append('<object style="position: absolute; top 50px;left: 50px; z-index: 100;display: block;" classid="clsid:67DABFBF-D0AB-41fa-9C46-CC0F21721616" width="320" height="260" codebase="http://go.divx.com/plugin/DivXBrowserPlugin.cab">'+

            '<param name="custommode" value="none" />'+

        '<param name="autoPlay" value="false" />'+
        '<param name="src" value="'+src+'" />'+

        '<embed style="position: absolute; top 50px;left: 50px; z-index: 100;display: block;" type="video/divx" src="'+src+'" custommode="none" width="320" height="260" autoPlay="false"  pluginspage="http://go.divx.com/plugin/download/">'+
        '</embed>'+
        '</object>'+
        '<br />No video? Get the DivX Web Player for <a style="text-decoration: underline;" href="http://download.divx.com/player/DivXWebPlayerInstaller.exe">Windows</a> or <a style="text-decoration: underline;" href="http://download.divx.com/player/DivXWebPlayer.dmg">Mac</a>');
        $div.appendTo("#panel2-2");
    },
    listeTorrents:function(){
        res ="";
        $.each( Torrent.model.liste, function(k,v){
           res += Torrent.view.listeTorrent(v,k);
        });
        $("#listorrent").html(res);
    },
    statsTorrent: function(hdduse, hddtotal,statreso){
        $("#storage").attr({"value":hdduse,"max":hddtotal,"title": Base.model.converter.bytes(hdduse,2)+" / "+Base.model.converter.bytes(hddtotal,2)});
        $("#vup").html((statreso[0] == 0 ? "":Base.model.converter.speed(statreso[0])));
        $("#vupl").html((statreso[1] == 0 ? "∞":Base.model.converter.speed(statreso[1])));
        $("#vupt").html(Base.model.converter.bytes(statreso[2],2));

        $("#vdl").html((statreso[3] == 0 ? "":Base.model.converter.speed(statreso[3])));
        $("#vdll").html((statreso[4] == 0 ? "∞":Base.model.converter.speed(statreso[4])));
        $("#vdlt").html(Base.model.converter.bytes(statreso[5],2));

    },

    addTorrent:{
        showAddTorrent: function (){
            $("#addTorrent").show();
        },
        hideAddTorrent: function (){
            $("#addTorrent").hide();
        },
        showTorrents : function(torrents){
            $("#addTorrentDetails").empty();
            $("#addTorrentDetails").append('<input type="hidden" name="nbtorrents" value="'+torrents.length+'">')
            $.each(torrents, function(k,v){
                Torrent.view.addTorrent.showTorrent(v,k);
            });
        },

        showTorrent: function(torrent,id){
            $fieldset = $("<fieldset><legend>"+torrent.nom+"</legend></fieldset>");
            if ( torrent.type == "movie"){
                //Type sois FILM ou Série
                $inputfilm = $('<input type="radio" name="torrent'+id+'type" value="film" id="torrent'+id+'typefilm">');
                $fieldset.append($inputfilm);
                $fieldset.append('<label for="torrent'+id+'typefilm">Film</label>');
                $inputserie = $('<input type="radio" name="torrent'+id+'type" value="serie" id="torrent'+id+'typeserie">');
                $fieldset.append($inputserie);
                $fieldset.append('<label for="torrent'+id+'typeserie">Série</label>');
                $inputfilm.click(function(e){
                    Torrent.view.addTorrent.showFileMovieTorrent(torrent.files,id);
                    var nom = torrent.nom.replace(/\.\d{4}.+/gi,"");
                    nom = nom.replace(/\./gi," ");
                    $('#torrent'+id+'suggestrecherche').val(nom);
                    Torrent.controller.addTorrent.rechercher(id);
                });
                $inputserie.click(function(e){
                    Torrent.view.addTorrent.showFileSerieTorrent(torrent.files,id);
                });
            }else{
                //Type MUSIQUE
            }
            $fieldset.append('<div id="torrent'+id+'files"></div>');
            $("#addTorrentDetails").append($fieldset);
        },
        showFileMovieTorrent: function(files,id){
            $("#torrent"+id+"files").empty();
            $tablefile = $('<table><thead><tr><th><input onchange="Base.controller.checkerCheckbox(this);" id="torrent'+id+'ajoutecheck" class="torrent'+id+'ajoutecheck" type="checkbox"><label for="torrent'+id+'ajoutecheck">Ajoute</label></th><th><input onchange="Base.controller.checkerCheckbox(this);" id="torrent'+id+'partagecheck" class="torrent'+id+'partagecheck" type="checkbox"><label for="torrent'+id+'partagecheck">Partage</label></th><th>Fichier</th><th>Complément</th></tr></thead></table>');
            $tbodyfile = $("<tbody></tbody>");
            $.each(files, function(k,v){
                $tbodyfile.append('<tr><td><input type="checkbox" name="torrent'+id+'ajoutecheckfile'+k+'" class="torrent'+id+'ajoutecheck"></td><td><input type="checkbox" name="torrent'+id+'partagecheckfile'+k+'" class="torrent'+id+'partagecheck"></td><td>'+ Base.model.path.basename(v.nom)+'</td><td><input type="text" placeholder="Truefrench.Unrated..." name="torrent'+id+'filecomplement'+k+'"></td></tr>');
            });
            $tablefile.append($tbodyfile);
            $("#torrent"+id+"files").append($tablefile);
            Torrent.view.addTorrent.addRechercher(id);
            $("#torrent"+id+"files").append('<h1>Testtt</h1>');
        },
        addRechercher : function(id){
            $("#torrent"+id+"files").append('<label>Recherche</label>');
            $ul = $('<ul style="list-style: none; width: 50%;"></ul>');
            $li = $('<li></li>');
            $input =  $('<input type="text" id="torrent'+id+'suggestrecherche" name="torrent'+id+'suggestrecherche">');
            $input[0].onupdate = $input[0].onkeyup = function() {
                if ($.trim($input[0].value).length > 1){
                    Torrent.controller.addTorrent.rechercher(id);
                }else{
                    $('#torrent'+id+'suggest').hide();
                }
            }
            $li.append($input);
            $ul.append($li);
            $ul.append('<li><div class="suggest" id="torrent'+id+'suggest" style="display: none;"></div></li>');
            $("#torrent"+id+"files").append($ul);

        },
        showRechercheFilms : function(id,films){
            $('#torrent'+id+'suggest').empty();
            $.each( films, function(k,v){
               Torrent.view.addTorrent.showRechercheFilm(id,v);
            });
            $('#torrent'+id+'suggest').show();
        },
        showRechercheFilm : function(id,film){
            $fieldset = $('<fieldset><legend>'+(film.titre ? film.titre:film.originaltitre)+'</legend></fieldset>');
            $fieldset.click ( function(e){
                console.log(film.code);
                $('#torrent'+id+'suggest').empty();
                $('#torrent'+id+'suggest').hide();
            });
            $table = $('<table class="noneventrowbg"></table>');
            if (film.image){
                $table.append('<tr><td rowspan="4" ><img src="'+Base.model.conf.base_url+"proxy/imageSetWidth/"+film.image.replace(/\//gi,"\\")+'/100.jpg"></td><td></td></tr>');

            }else{

            }
            if ( film.acteur){
            $table.append('<tr><td>Acteur : '+film.acteur+'</td></tr>');
            }else{
                $table.append('<tr><td></td></tr>');
            }
            $table.append('<tr><td></td></tr>');
            $table.append('<tr><td>'+(film.realisateur ?'Par : '+film.realisateur:"")+(film.anneeprod ?' en '+film.anneeprod:"")+'</td></tr>');

            $fieldset.append($table);
            $('#torrent'+id+'suggest').append($fieldset);
        },
        showFileSerieTorrent: function(files,id){
            $("#torrent"+id+"files").empty();
            $tablefile = $('<table><thead><tr><th><input onchange="Base.controller.checkerCheckbox(this);" id="torrent'+id+'ajoutecheck" class="torrent'+id+'ajoutecheck" type="checkbox"><label for="torrent'+id+'ajoutecheck">Ajoute</label></th><th><input onchange="Base.controller.checkerCheckbox(this);" id="torrent'+id+'partagecheck" class="torrent'+id+'partagecheck" type="checkbox"><label for="torrent'+id+'partagecheck">Partage</label></th><th>Fichier</th><th>Saison</th><th>Episode</th><th>Complément</th></tr></thead></table>');
            $tbodyfile = $("<tbody></tbody>");
            $.each(files, function(k,v){
                saisons = v.nom.match(Torrent.model.regexsaison);
                if ( saisons != null){
                saisons = saisons[saisons.length-1];
                saison = Base.model.converter.iv(saisons);
                    if (saison == null)
                        saison = Base.model.converter.iv(saisons.substr(1));
                    saisons =saison;
                }
                episode = v.nom.match(Torrent.model.regexepisode);
                if ( episode != null){
                    episode = episode[episode.length-1];
                    episode = Base.model.converter.iv(episode.substr(1));
                }else{
                    episode = v.nom.match(Torrent.model.regexepisode1);
                    if ( episode != null){
                        episode = episode[episode.length-1];
                        episode = Base.model.converter.iv(episode);
                    }
                }
                    $tbodyfile.append('<tr><td><input type="checkbox" name="torrent'+id+'ajoutecheckfile'+k+'" class="torrent'+id+'ajoutecheck"></td><td><input type="checkbox" name="torrent'+id+'partagecheckfile'+k+'" class="torrent'+id+'partagecheck"></td><td>'+ Base.model.path.basename(v.nom)+'</td><td><input type="text" placeholder="1,2,3" value="'+( saisons == null ? "":saisons)+'" name="torrent'+id+'filesaison'+k+'"></td><td><input type="text" placeholder="1,2,3.." value="'+( episode == null ? "":episode)+'" name="torrent'+id+'fileepisode'+k+'"></td><td><input type="text" placeholder="Truefrench.Unrated..." name="torrent'+id+'filecomplement'+k+'"></td></tr>');
            });
            $tablefile.append($tbodyfile);
            $("#torrent"+id+"files").append($tablefile);

        }


    }






};